geom_text_repel(aes(label = title_for_plot),force = 5)+
scale_y_log10()+geom_smooth(color = "white")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
geom_text_repel(aes(label = title_for_plot),force = 10)+
scale_y_log10()+geom_smooth(color = "white")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
![](/media/rap.png)
top_ranking_gender<-rankings%>%
distinct(ID,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(5,points)
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
geom_text_repel(aes(label = title_for_plot),force = 10)+
scale_y_log10()+geom_smooth(color = "white")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
geom_text_repel(aes(label = title_for_plot),force = 15)+
scale_y_log10()+geom_smooth(color = "white")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
geom_text_repel(aes(label = title_for_plot),force = 20)+
scale_y_log10()+geom_smooth(color = "white")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
geom_text_repel(aes(label = title_for_plot),force = 20)+
scale_y_log10()+geom_smooth(color = "white")+
labs(title = "How does quality of songs change?")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
geom_text_repel(aes(label = title_for_plot),force = 20)+
scale_y_log10()+geom_smooth(color = "white")+
labs(title = "How does quality of songs change through time?")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
scale_y_log10()+geom_smooth(color = "white")+
labs(title = "How does quality of songs change through time?")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
scale_y_log10()+geom_smooth(color = "white")+
labs(title = "How does quality of songs change through time?")+
scale_color_manual(values = c("red","yellow","white"))+
theme_ft_rc()
View(top_ranking_gender)
top_ranking_gender<-rankings%>%
distinct(ID,,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(5,points)
View(rankings)
library(tidyverse)
library(hrbrthemes)
library(gganimate)
library(plotly)
polls <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-04-14/polls.csv')
rankings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-04-14/rankings.csv')
top_ranking_gender<-rankings%>%
distinct(ID,,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(5,points)
top_ranking_gender<-rankings%>%
distinct(ID,,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(5,points)
top_ranking_gender<-rankings%>%
distinct(ID,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(5,points)
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
scale_y_log10()+geom_smooth(color = "white")+
labs(title = "How does quality of songs change through time?")+
scale_color_manual(values = c("red","yellow","white"))+
theme_ft_rc()
View(top_ranking_gender)
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))
top_ranking_gender<-rankings%>%
distinct(ID,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(10,points)
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null")
ggplotly(top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null"))
ggplotly(top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null",
plot.margin = margin(-10,0,0,)))
ggplotly(top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null",
plot.margin = margin(-10,0,0,0)))
ggplotly(top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null",
plot.margin = margin(-5,0,0,0)))
ggplotly(top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null",
plot.margin = margin(0,0,0,0)))
ggplotly(top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null",
plot.margin = margin(0,0,5,0)))
ggplotly(top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null",
plot.margin = margin(0,0,15,0)))
ggplotly(top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null"))
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()+
theme(legend.position = "null")
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
scale_y_log10()+geom_smooth(color = "white")+
labs(title = "How does quality of songs change through time?")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
View(top_ranking_gender)
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title))+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title),check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = points),check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = sqrt(points)),check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = sqrt(points)*10),check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text_repel(aes(label = title))+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text_repel(aes(label = title), force = 20)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text_repel(aes(label = title), force = 20)+
scale_y_log10()+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*10))+
scale_color_manual(values = c("indianred1","yellow","white"))+
scale_y_log10()+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
scale_y_log10()+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
scale_y_log10()+
geom_text(aes(label = title))+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
scale_y_log10()+
geom_text(aes(label = title,size = points))+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
scale_y_log10()+
geom_text(aes(label = title,size = points*100))+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
scale_y_log10()+
geom_text(aes(label = title,size = points*200))+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
scale_y_log10()+
geom_text(aes(label = title,size = points*200), check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = points*200), check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = points*300), check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
View(top_ranking_gender)
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = points*300),vjust = 1)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = points*300),vjust = 1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender<-rankings%>%
distinct(ID,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(10,points)%>%
mutate(title = reorder(title, points))
View(top_ranking_gender)
top_ranking_gender<-rankings%>%
distinct(ID,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(10,points)%>%
mutate(title = reorder(title, points),
size = row_number())
top_ranking_gender<-rankings%>%
distinct(ID,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(10,points)%>%
ungroup()%>%
mutate(title = reorder(title, points),
size = row_number())
top_ranking_gender<-rankings%>%
distinct(ID,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(10,points)%>%
ungroup()%>%
mutate(title = reorder(title, points),
size = 1/row_number())
top_ranking_gender<-rankings%>%
distinct(ID,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(10,points)%>%
ungroup()%>%
mutate(title = reorder(title, points),
size = 1/row_number()*33)
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = size),vjust = 1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = size*100),vjust = 1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = size*300),vjust = 1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*100))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = size*10000),vjust = 1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = size*10000),vjust = 1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*500))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title,size = size*10000),vjust = 1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
scale_y_log10()+geom_smooth(color = "white")+
labs(title = "How does quality of songs change through time?")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
rankings%>%
filter(ID!=70)%>%
mutate(title_for_plot = ifelse(title%in%top_ranking_gender$title,title, ""))%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(alpha = 0.6)+
scale_y_log10()+geom_smooth(color = "white")+
labs(title = "How does quality of songs change through time?")+
scale_color_manual(values = c("indianred1","yellow","white"))+
theme_ft_rc()
top_ranking_gender<-rankings%>%
distinct(ID,year,title, artist, gender, points)%>%
group_by(gender)%>%
top_n(10,points)%>%
ungroup()
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*500))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title),vjust = 1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*500))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text(aes(label = title),vjust = -1, check_overlap = TRUE)+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*500))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text_repel(aes(label = title))+
theme_ft_rc()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*500))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text_repel(aes(label = title))+
theme_ft_rc()+
scale_y_log10()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*500))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text_repel(aes(label = title), force = 10)+
theme_ft_rc()+
scale_y_log10()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*500))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text_repel(aes(label = title), force = 20)+
theme_ft_rc()+
scale_y_log10()+
theme(legend.position = "null")
top_ranking_gender%>%
ggplot(aes(x = year, y = points, color = gender))+
geom_point(aes(size = points*500))+
scale_color_manual(values = c("indianred1","yellow","white"))+
geom_text_repel(aes(label = title), force = 20)+
labs(title="The top 10 songs performed by artists of each gender ")+
theme_ft_rc()+
scale_y_log10()+
theme(legend.position = "null")
rankings%>%
group_by(year)%>%
summarise(av_points = mean(points))%>%
ggplot(aes(x = year, y = av_points),group = 1)+
geom_point(color = ft_cols$yellow)+
geom_line(color = ft_cols$white)+
labs(x = "Year",
y = "Average ranking"
)+
theme_ft_rc()
