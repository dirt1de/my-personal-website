---
title: Data analysis on Friends
author: Xuxin Zhang
date: '2020-09-16'
slug: data-analysis-on-friends
categories:
  - R project
tags:
  - text mining
  - tidymodel
  - sentiment analysis
  - data visualization
subtitle: ''
summary: ''
authors: []
lastmod: '2020-09-16T16:06:34+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p><img src="/media/friends.jpg" /></p>
<pre class="r"><code>library(tidyverse)
library(tidymodels)
library(plotly)
theme_set(theme_light())
friends &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-08/friends.csv&#39;)
friends_emotions &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-08/friends_emotions.csv&#39;)
friends_info &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-08/friends_info.csv&#39;)</code></pre>
<pre class="r"><code>library(stringr)
remove&lt;-&quot;The One with|The One Where&quot;
title_clean&lt;-stringr::str_remove_all(friends_info$title,remove)

friends_info%&gt;%mutate(epi_num = row_number())%&gt;%
  ggplot(aes(x = epi_num, y = imdb_rating ))+
  geom_point(aes(color = as.factor(season),size = us_views_millions))+
  geom_path(aes(color = as.factor(season)))+geom_text(label = title_clean,check_overlap = TRUE)+
  theme(legend.position = &quot;null&quot;)+geom_smooth()+
  scale_color_brewer(palette = &quot;Paired&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/2020-09-16-data-analysis-on-friends_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>friends_info%&gt;%
  ggplot(aes(x = us_views_millions, y = imdb_rating))+
  geom_point()+geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/2020-09-16-data-analysis-on-friends_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>library(ggridges)
friends_info%&gt;%mutate(season = as.factor(season))%&gt;%
  ggplot(aes(y  = imdb_rating, x = season,fill = season))+
  geom_boxplot(alpha  = 0.6)+
  geom_smooth(aes(group = 1), se = FALSE)+
  scale_fill_brewer(palette = &quot;Paired&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/2020-09-16-data-analysis-on-friends_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>We can find out the best 15 episodes as well as the worst 15 episodes.</p>
<pre class="r"><code>ggplotly(friends_info%&gt;%distinct(title,imdb_rating,season)%&gt;%
  top_n(15,imdb_rating)%&gt;%
  ggplot(aes(x = imdb_rating,
             y = reorder(title, imdb_rating),
             color = as.factor(season)))+
  geom_point(size = 3)+geom_segment(aes(x = 9.0,
                                        xend = imdb_rating,
                                        y = title, 
                                        yend = title),
                                        size = 1.5,
                                    alpha = 0.5)+
  scale_color_brewer(palette = &quot;Paired&quot;))</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[9.4],"y":[17],"text":"imdb_rating: 9.4<br />reorder(title, imdb_rating): The One with the Prom Video<br />as.factor(season): 2","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(166,206,227,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(166,206,227,1)"}},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9.1,9.1],"y":[5,7],"text":["imdb_rating: 9.1<br />reorder(title, imdb_rating): The One with the Flashback<br />as.factor(season): 3","imdb_rating: 9.1<br />reorder(title, imdb_rating): The One with the Morning After<br />as.factor(season): 3"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(31,120,180,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(31,120,180,1)"}},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9.1,9.1,9.5,9.2],"y":[6,3,18,13],"text":["imdb_rating: 9.1<br />reorder(title, imdb_rating): The One with the Jellyfish<br />as.factor(season): 4","imdb_rating: 9.1<br />reorder(title, imdb_rating): The One with Chandler in a Box<br />as.factor(season): 4","imdb_rating: 9.5<br />reorder(title, imdb_rating): The One with the Embryos<br />as.factor(season): 4","imdb_rating: 9.2<br />reorder(title, imdb_rating): The One with Ross' Wedding<br />as.factor(season): 4"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(178,223,138,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(178,223,138,1)"}},"hoveron":"points","name":"4","legendgroup":"4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9.2,9.1,9.1,9.7,9.1],"y":[11,4,2,20,1],"text":["imdb_rating: 9.2<br />reorder(title, imdb_rating): The One with All the Thanksgivings<br />as.factor(season): 5","imdb_rating: 9.1<br />reorder(title, imdb_rating): The One with Ross's Sandwich<br />as.factor(season): 5","imdb_rating: 9.1<br />reorder(title, imdb_rating): The One with All the Resolutions<br />as.factor(season): 5","imdb_rating: 9.7<br />reorder(title, imdb_rating): The One Where Everybody Finds Out<br />as.factor(season): 5","imdb_rating: 9.1<br />reorder(title, imdb_rating): The One in Vegas<br />as.factor(season): 5"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(51,160,44,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(51,160,44,1)"}},"hoveron":"points","name":"5","legendgroup":"5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9.2,9.1,9.3],"y":[10,9,14],"text":["imdb_rating: 9.2<br />reorder(title, imdb_rating): The One Where Ross Got High<br />as.factor(season): 6","imdb_rating: 9.1<br />reorder(title, imdb_rating): The One with Unagi<br />as.factor(season): 6","imdb_rating: 9.3<br />reorder(title, imdb_rating): The One with the Proposal<br />as.factor(season): 6"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(251,154,153,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(251,154,153,1)"}},"hoveron":"points","name":"6","legendgroup":"6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9.2],"y":[12],"text":"imdb_rating: 9.2<br />reorder(title, imdb_rating): The One with Monica and Chandler's Wedding<br />as.factor(season): 7","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(227,26,28,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)"}},"hoveron":"points","name":"7","legendgroup":"7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9.1,9.3,9.3],"y":[8,16,15],"text":["imdb_rating: 9.1<br />reorder(title, imdb_rating): The One with the Red Sweater<br />as.factor(season): 8","imdb_rating: 9.3<br />reorder(title, imdb_rating): The One with the Videotape<br />as.factor(season): 8","imdb_rating: 9.3<br />reorder(title, imdb_rating): The One with the Rumor<br />as.factor(season): 8"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(253,191,111,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(253,191,111,1)"}},"hoveron":"points","name":"8","legendgroup":"8","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9.7],"y":[19],"text":"imdb_rating: 9.7<br />reorder(title, imdb_rating): The Last One<br />as.factor(season): 10","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,127,0,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,127,0,1)"}},"hoveron":"points","name":"10","legendgroup":"10","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,9.4],"y":[17,17],"text":"x: 9<br />title: The One with the Prom Video<br />imdb_rating: 9.4<br />title: 17<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Prom Video<br />as.factor(season): 2","type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(166,206,227,0.5)","dash":"solid"},"hoveron":"points","name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,9.1,null,9,9.1],"y":[5,5,null,7,7],"text":["x: 9<br />title: The One with the Flashback<br />imdb_rating: 9.1<br />title:  5<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Flashback<br />as.factor(season): 3","x: 9<br />title: The One with the Flashback<br />imdb_rating: 9.1<br />title:  5<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Flashback<br />as.factor(season): 3",null,"x: 9<br />title: The One with the Morning After<br />imdb_rating: 9.1<br />title:  7<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Morning After<br />as.factor(season): 3","x: 9<br />title: The One with the Morning After<br />imdb_rating: 9.1<br />title:  7<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Morning After<br />as.factor(season): 3"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(31,120,180,0.5)","dash":"solid"},"hoveron":"points","name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,9.1,null,9,9.1,null,9,9.5,null,9,9.2],"y":[6,6,null,3,3,null,18,18,null,13,13],"text":["x: 9<br />title: The One with the Jellyfish<br />imdb_rating: 9.1<br />title:  6<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Jellyfish<br />as.factor(season): 4","x: 9<br />title: The One with the Jellyfish<br />imdb_rating: 9.1<br />title:  6<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Jellyfish<br />as.factor(season): 4",null,"x: 9<br />title: The One with Chandler in a Box<br />imdb_rating: 9.1<br />title:  3<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Chandler in a Box<br />as.factor(season): 4","x: 9<br />title: The One with Chandler in a Box<br />imdb_rating: 9.1<br />title:  3<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Chandler in a Box<br />as.factor(season): 4",null,"x: 9<br />title: The One with the Embryos<br />imdb_rating: 9.5<br />title: 18<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Embryos<br />as.factor(season): 4","x: 9<br />title: The One with the Embryos<br />imdb_rating: 9.5<br />title: 18<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Embryos<br />as.factor(season): 4",null,"x: 9<br />title: The One with Ross' Wedding<br />imdb_rating: 9.2<br />title: 13<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Ross' Wedding<br />as.factor(season): 4","x: 9<br />title: The One with Ross' Wedding<br />imdb_rating: 9.2<br />title: 13<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Ross' Wedding<br />as.factor(season): 4"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(178,223,138,0.5)","dash":"solid"},"hoveron":"points","name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,9.2,null,9,9.1,null,9,9.1,null,9,9.7,null,9,9.1],"y":[11,11,null,4,4,null,2,2,null,20,20,null,1,1],"text":["x: 9<br />title: The One with All the Thanksgivings<br />imdb_rating: 9.2<br />title: 11<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with All the Thanksgivings<br />as.factor(season): 5","x: 9<br />title: The One with All the Thanksgivings<br />imdb_rating: 9.2<br />title: 11<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with All the Thanksgivings<br />as.factor(season): 5",null,"x: 9<br />title: The One with Ross's Sandwich<br />imdb_rating: 9.1<br />title:  4<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Ross's Sandwich<br />as.factor(season): 5","x: 9<br />title: The One with Ross's Sandwich<br />imdb_rating: 9.1<br />title:  4<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Ross's Sandwich<br />as.factor(season): 5",null,"x: 9<br />title: The One with All the Resolutions<br />imdb_rating: 9.1<br />title:  2<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with All the Resolutions<br />as.factor(season): 5","x: 9<br />title: The One with All the Resolutions<br />imdb_rating: 9.1<br />title:  2<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with All the Resolutions<br />as.factor(season): 5",null,"x: 9<br />title: The One Where Everybody Finds Out<br />imdb_rating: 9.7<br />title: 20<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where Everybody Finds Out<br />as.factor(season): 5","x: 9<br />title: The One Where Everybody Finds Out<br />imdb_rating: 9.7<br />title: 20<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where Everybody Finds Out<br />as.factor(season): 5",null,"x: 9<br />title: The One in Vegas<br />imdb_rating: 9.1<br />title:  1<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One in Vegas<br />as.factor(season): 5","x: 9<br />title: The One in Vegas<br />imdb_rating: 9.1<br />title:  1<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One in Vegas<br />as.factor(season): 5"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(51,160,44,0.5)","dash":"solid"},"hoveron":"points","name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,9.2,null,9,9.1,null,9,9.3],"y":[10,10,null,9,9,null,14,14],"text":["x: 9<br />title: The One Where Ross Got High<br />imdb_rating: 9.2<br />title: 10<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where Ross Got High<br />as.factor(season): 6","x: 9<br />title: The One Where Ross Got High<br />imdb_rating: 9.2<br />title: 10<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where Ross Got High<br />as.factor(season): 6",null,"x: 9<br />title: The One with Unagi<br />imdb_rating: 9.1<br />title:  9<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Unagi<br />as.factor(season): 6","x: 9<br />title: The One with Unagi<br />imdb_rating: 9.1<br />title:  9<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Unagi<br />as.factor(season): 6",null,"x: 9<br />title: The One with the Proposal<br />imdb_rating: 9.3<br />title: 14<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Proposal<br />as.factor(season): 6","x: 9<br />title: The One with the Proposal<br />imdb_rating: 9.3<br />title: 14<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Proposal<br />as.factor(season): 6"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(251,154,153,0.5)","dash":"solid"},"hoveron":"points","name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,9.2],"y":[12,12],"text":"x: 9<br />title: The One with Monica and Chandler's Wedding<br />imdb_rating: 9.2<br />title: 12<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Monica and Chandler's Wedding<br />as.factor(season): 7","type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(227,26,28,0.5)","dash":"solid"},"hoveron":"points","name":"7","legendgroup":"7","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,9.1,null,9,9.3,null,9,9.3],"y":[8,8,null,16,16,null,15,15],"text":["x: 9<br />title: The One with the Red Sweater<br />imdb_rating: 9.1<br />title:  8<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Red Sweater<br />as.factor(season): 8","x: 9<br />title: The One with the Red Sweater<br />imdb_rating: 9.1<br />title:  8<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Red Sweater<br />as.factor(season): 8",null,"x: 9<br />title: The One with the Videotape<br />imdb_rating: 9.3<br />title: 16<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Videotape<br />as.factor(season): 8","x: 9<br />title: The One with the Videotape<br />imdb_rating: 9.3<br />title: 16<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Videotape<br />as.factor(season): 8",null,"x: 9<br />title: The One with the Rumor<br />imdb_rating: 9.3<br />title: 15<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Rumor<br />as.factor(season): 8","x: 9<br />title: The One with the Rumor<br />imdb_rating: 9.3<br />title: 15<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Rumor<br />as.factor(season): 8"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(253,191,111,0.5)","dash":"solid"},"hoveron":"points","name":"8","legendgroup":"8","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,9.7],"y":[19,19],"text":"x: 9<br />title: The Last One<br />imdb_rating: 9.7<br />title: 19<br />imdb_rating: 9<br />reorder(title, imdb_rating): The Last One<br />as.factor(season): 10","type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(255,127,0,0.5)","dash":"solid"},"hoveron":"points","name":"10","legendgroup":"10","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":271.050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[8.965,9.735],"tickmode":"array","ticktext":["9.0","9.2","9.4","9.6"],"tickvals":[9,9.2,9.4,9.6],"categoryorder":"array","categoryarray":["9.0","9.2","9.4","9.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088,"zeroline":false,"anchor":"y","title":{"text":"imdb_rating","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,20.6],"tickmode":"array","ticktext":["The One in Vegas","The One with All the Resolutions","The One with Chandler in a Box","The One with Ross's Sandwich","The One with the Flashback","The One with the Jellyfish","The One with the Morning After","The One with the Red Sweater","The One with Unagi","The One Where Ross Got High","The One with All the Thanksgivings","The One with Monica and Chandler's Wedding","The One with Ross' Wedding","The One with the Proposal","The One with the Rumor","The One with the Videotape","The One with the Prom Video","The One with the Embryos","The Last One","The One Where Everybody Finds Out"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"categoryorder":"array","categoryarray":["The One in Vegas","The One with All the Resolutions","The One with Chandler in a Box","The One with Ross's Sandwich","The One with the Flashback","The One with the Jellyfish","The One with the Morning After","The One with the Red Sweater","The One with Unagi","The One Where Ross Got High","The One with All the Thanksgivings","The One with Monica and Chandler's Wedding","The One with Ross' Wedding","The One with the Proposal","The One with the Rumor","The One with the Videotape","The One with the Prom Video","The One with the Embryos","The Last One","The One Where Everybody Finds Out"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088,"zeroline":false,"anchor":"x","title":{"text":"reorder(title, imdb_rating)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"as.factor(season)","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"15bf778ce574":{"x":{},"y":{},"colour":{},"type":"scatter"},"15bf7332c268b":{"x":{},"y":{},"xend":{},"yend":{},"x.1":{},"y.1":{},"colour":{}}},"cur_data":"15bf778ce574","visdat":{"15bf778ce574":["function (y) ","x"],"15bf7332c268b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggplotly(friends_info%&gt;%distinct(title,imdb_rating,season)%&gt;%
  top_n(-15,imdb_rating)%&gt;%
  ggplot(aes(x = imdb_rating,
             y = reorder(title, imdb_rating),
             color = as.factor(season)))+
  geom_point(size = 3)+geom_segment(aes(x = 9.0, xend = imdb_rating, y = title, yend = title),size = 1.5,alpha = 0.5)+
  scale_color_brewer(palette = &quot;Paired&quot;))</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"data":[{"x":[7.9,7.9],"y":[9,10],"text":["imdb_rating: 7.9<br />reorder(title, imdb_rating): The One with the Evil Orthodontist<br />as.factor(season): 1","imdb_rating: 7.9<br />reorder(title, imdb_rating): The One with the Fake Monica<br />as.factor(season): 1"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(166,206,227,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(166,206,227,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8,8,8],"y":[16,15,19],"text":["imdb_rating: 8.0<br />reorder(title, imdb_rating): The One with Phoebe's Husband<br />as.factor(season): 2","imdb_rating: 8.0<br />reorder(title, imdb_rating): The One with Phoebe's Dad<br />as.factor(season): 2","imdb_rating: 8.0<br />reorder(title, imdb_rating): The One with Russ<br />as.factor(season): 2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(31,120,180,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(31,120,180,1)"}},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.9],"y":[8],"text":"imdb_rating: 7.9<br />reorder(title, imdb_rating): The One with Phoebe's Ex-Partner<br />as.factor(season): 3","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(178,223,138,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(178,223,138,1)"}},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.9,7.2],"y":[7,1],"text":["imdb_rating: 7.9<br />reorder(title, imdb_rating): The One Where They're Going to Party!<br />as.factor(season): 4","imdb_rating: 7.2<br />reorder(title, imdb_rating): The One with the Invitation<br />as.factor(season): 4"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(51,160,44,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(51,160,44,1)"}},"hoveron":"points","name":"4","legendgroup":"4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8],"y":[14],"text":"imdb_rating: 8.0<br />reorder(title, imdb_rating): The One Where Rachel Smokes<br />as.factor(season): 5","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(251,154,153,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(251,154,153,1)"}},"hoveron":"points","name":"5","legendgroup":"5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.4],"y":[2],"text":"imdb_rating: 7.4<br />reorder(title, imdb_rating): The One with Mac and C.H.E.E.S.E.<br />as.factor(season): 6","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(227,26,28,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)"}},"hoveron":"points","name":"6","legendgroup":"6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.5],"y":[5],"text":"imdb_rating: 7.5<br />reorder(title, imdb_rating): The One with the Vows<br />as.factor(season): 7","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(253,191,111,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(253,191,111,1)"}},"hoveron":"points","name":"7","legendgroup":"7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.9,8,7.5],"y":[11,18,4],"text":["imdb_rating: 7.9<br />reorder(title, imdb_rating): The One with the Stain<br />as.factor(season): 8","imdb_rating: 8.0<br />reorder(title, imdb_rating): The One with Ross's Step Forward<br />as.factor(season): 8","imdb_rating: 7.5<br />reorder(title, imdb_rating): The One with Joey's Interview<br />as.factor(season): 8"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,127,0,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,127,0,1)"}},"hoveron":"points","name":"8","legendgroup":"8","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.5,8,8,7.8],"y":[3,13,17,6],"text":["imdb_rating: 7.5<br />reorder(title, imdb_rating): The One with Christmas in Tulsa<br />as.factor(season): 9","imdb_rating: 8.0<br />reorder(title, imdb_rating): The One Where Rachel Goes Back to Work<br />as.factor(season): 9","imdb_rating: 8.0<br />reorder(title, imdb_rating): The One with Phoebe's Rats<br />as.factor(season): 9","imdb_rating: 7.8<br />reorder(title, imdb_rating): The One with the Donor<br />as.factor(season): 9"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(202,178,214,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(202,178,214,1)"}},"hoveron":"points","name":"9","legendgroup":"9","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8],"y":[12],"text":"imdb_rating: 8.0<br />reorder(title, imdb_rating): The One Where Chandler Gets Caught<br />as.factor(season): 10","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(106,61,154,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(106,61,154,1)"}},"hoveron":"points","name":"10","legendgroup":"10","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,7.9,null,9,7.9],"y":[9,9,null,10,10],"text":["x: 9<br />title: The One with the Evil Orthodontist<br />imdb_rating: 7.9<br />title:  9<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Evil Orthodontist<br />as.factor(season): 1","x: 9<br />title: The One with the Evil Orthodontist<br />imdb_rating: 7.9<br />title:  9<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Evil Orthodontist<br />as.factor(season): 1",null,"x: 9<br />title: The One with the Fake Monica<br />imdb_rating: 7.9<br />title: 10<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Fake Monica<br />as.factor(season): 1","x: 9<br />title: The One with the Fake Monica<br />imdb_rating: 7.9<br />title: 10<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Fake Monica<br />as.factor(season): 1"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(166,206,227,0.5)","dash":"solid"},"hoveron":"points","name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,8,null,9,8,null,9,8],"y":[16,16,null,15,15,null,19,19],"text":["x: 9<br />title: The One with Phoebe's Husband<br />imdb_rating: 8.0<br />title: 16<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Phoebe's Husband<br />as.factor(season): 2","x: 9<br />title: The One with Phoebe's Husband<br />imdb_rating: 8.0<br />title: 16<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Phoebe's Husband<br />as.factor(season): 2",null,"x: 9<br />title: The One with Phoebe's Dad<br />imdb_rating: 8.0<br />title: 15<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Phoebe's Dad<br />as.factor(season): 2","x: 9<br />title: The One with Phoebe's Dad<br />imdb_rating: 8.0<br />title: 15<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Phoebe's Dad<br />as.factor(season): 2",null,"x: 9<br />title: The One with Russ<br />imdb_rating: 8.0<br />title: 19<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Russ<br />as.factor(season): 2","x: 9<br />title: The One with Russ<br />imdb_rating: 8.0<br />title: 19<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Russ<br />as.factor(season): 2"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(31,120,180,0.5)","dash":"solid"},"hoveron":"points","name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,7.9],"y":[8,8],"text":"x: 9<br />title: The One with Phoebe's Ex-Partner<br />imdb_rating: 7.9<br />title:  8<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Phoebe's Ex-Partner<br />as.factor(season): 3","type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(178,223,138,0.5)","dash":"solid"},"hoveron":"points","name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,7.9,null,9,7.2],"y":[7,7,null,1,1],"text":["x: 9<br />title: The One Where They're Going to Party!<br />imdb_rating: 7.9<br />title:  7<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where They're Going to Party!<br />as.factor(season): 4","x: 9<br />title: The One Where They're Going to Party!<br />imdb_rating: 7.9<br />title:  7<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where They're Going to Party!<br />as.factor(season): 4",null,"x: 9<br />title: The One with the Invitation<br />imdb_rating: 7.2<br />title:  1<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Invitation<br />as.factor(season): 4","x: 9<br />title: The One with the Invitation<br />imdb_rating: 7.2<br />title:  1<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Invitation<br />as.factor(season): 4"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(51,160,44,0.5)","dash":"solid"},"hoveron":"points","name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,8],"y":[14,14],"text":"x: 9<br />title: The One Where Rachel Smokes<br />imdb_rating: 8.0<br />title: 14<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where Rachel Smokes<br />as.factor(season): 5","type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(251,154,153,0.5)","dash":"solid"},"hoveron":"points","name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,7.4],"y":[2,2],"text":"x: 9<br />title: The One with Mac and C.H.E.E.S.E.<br />imdb_rating: 7.4<br />title:  2<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Mac and C.H.E.E.S.E.<br />as.factor(season): 6","type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(227,26,28,0.5)","dash":"solid"},"hoveron":"points","name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,7.5],"y":[5,5],"text":"x: 9<br />title: The One with the Vows<br />imdb_rating: 7.5<br />title:  5<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Vows<br />as.factor(season): 7","type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(253,191,111,0.5)","dash":"solid"},"hoveron":"points","name":"7","legendgroup":"7","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,7.9,null,9,8,null,9,7.5],"y":[11,11,null,18,18,null,4,4],"text":["x: 9<br />title: The One with the Stain<br />imdb_rating: 7.9<br />title: 11<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Stain<br />as.factor(season): 8","x: 9<br />title: The One with the Stain<br />imdb_rating: 7.9<br />title: 11<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Stain<br />as.factor(season): 8",null,"x: 9<br />title: The One with Ross's Step Forward<br />imdb_rating: 8.0<br />title: 18<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Ross's Step Forward<br />as.factor(season): 8","x: 9<br />title: The One with Ross's Step Forward<br />imdb_rating: 8.0<br />title: 18<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Ross's Step Forward<br />as.factor(season): 8",null,"x: 9<br />title: The One with Joey's Interview<br />imdb_rating: 7.5<br />title:  4<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Joey's Interview<br />as.factor(season): 8","x: 9<br />title: The One with Joey's Interview<br />imdb_rating: 7.5<br />title:  4<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Joey's Interview<br />as.factor(season): 8"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(255,127,0,0.5)","dash":"solid"},"hoveron":"points","name":"8","legendgroup":"8","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,7.5,null,9,8,null,9,8,null,9,7.8],"y":[3,3,null,13,13,null,17,17,null,6,6],"text":["x: 9<br />title: The One with Christmas in Tulsa<br />imdb_rating: 7.5<br />title:  3<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Christmas in Tulsa<br />as.factor(season): 9","x: 9<br />title: The One with Christmas in Tulsa<br />imdb_rating: 7.5<br />title:  3<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Christmas in Tulsa<br />as.factor(season): 9",null,"x: 9<br />title: The One Where Rachel Goes Back to Work<br />imdb_rating: 8.0<br />title: 13<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where Rachel Goes Back to Work<br />as.factor(season): 9","x: 9<br />title: The One Where Rachel Goes Back to Work<br />imdb_rating: 8.0<br />title: 13<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where Rachel Goes Back to Work<br />as.factor(season): 9",null,"x: 9<br />title: The One with Phoebe's Rats<br />imdb_rating: 8.0<br />title: 17<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Phoebe's Rats<br />as.factor(season): 9","x: 9<br />title: The One with Phoebe's Rats<br />imdb_rating: 8.0<br />title: 17<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with Phoebe's Rats<br />as.factor(season): 9",null,"x: 9<br />title: The One with the Donor<br />imdb_rating: 7.8<br />title:  6<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Donor<br />as.factor(season): 9","x: 9<br />title: The One with the Donor<br />imdb_rating: 7.8<br />title:  6<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One with the Donor<br />as.factor(season): 9"],"type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(202,178,214,0.5)","dash":"solid"},"hoveron":"points","name":"9","legendgroup":"9","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,8],"y":[12,12],"text":"x: 9<br />title: The One Where Chandler Gets Caught<br />imdb_rating: 8.0<br />title: 12<br />imdb_rating: 9<br />reorder(title, imdb_rating): The One Where Chandler Gets Caught<br />as.factor(season): 10","type":"scatter","mode":"lines","line":{"width":5.66929133858268,"color":"rgba(106,61,154,0.5)","dash":"solid"},"hoveron":"points","name":"10","legendgroup":"10","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":247.671232876712},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[7.11,9.09],"tickmode":"array","ticktext":["7.5","8.0","8.5","9.0"],"tickvals":[7.5,8,8.5,9],"categoryorder":"array","categoryarray":["7.5","8.0","8.5","9.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088,"zeroline":false,"anchor":"y","title":{"text":"imdb_rating","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,19.6],"tickmode":"array","ticktext":["The One with the Invitation","The One with Mac and C.H.E.E.S.E.","The One with Christmas in Tulsa","The One with Joey's Interview","The One with the Vows","The One with the Donor","The One Where They're Going to Party!","The One with Phoebe's Ex-Partner","The One with the Evil Orthodontist","The One with the Fake Monica","The One with the Stain","The One Where Chandler Gets Caught","The One Where Rachel Goes Back to Work","The One Where Rachel Smokes","The One with Phoebe's Dad","The One with Phoebe's Husband","The One with Phoebe's Rats","The One with Ross's Step Forward","The One with Russ"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"categoryorder":"array","categoryarray":["The One with the Invitation","The One with Mac and C.H.E.E.S.E.","The One with Christmas in Tulsa","The One with Joey's Interview","The One with the Vows","The One with the Donor","The One Where They're Going to Party!","The One with Phoebe's Ex-Partner","The One with the Evil Orthodontist","The One with the Fake Monica","The One with the Stain","The One Where Chandler Gets Caught","The One Where Rachel Goes Back to Work","The One Where Rachel Smokes","The One with Phoebe's Dad","The One with Phoebe's Husband","The One with Phoebe's Rats","The One with Ross's Step Forward","The One with Russ"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088,"zeroline":false,"anchor":"x","title":{"text":"reorder(title, imdb_rating)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"as.factor(season)","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"15bf773d74453":{"x":{},"y":{},"colour":{},"type":"scatter"},"15bf739c6e08f":{"x":{},"y":{},"xend":{},"yend":{},"x.1":{},"y.1":{},"colour":{}}},"cur_data":"15bf773d74453","visdat":{"15bf773d74453":["function (y) ","x"],"15bf739c6e08f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>friends%&gt;%count(speaker)%&gt;%
  filter(speaker!=&quot;NA&quot;)%&gt;%
  filter(n&gt;120)%&gt;%arrange(desc(n))%&gt;%
  ggplot(aes(x = reorder(speaker,n), y = n, fill = speaker))+
  geom_col(show.legend = FALSE,alpha= 0.7)+coord_polar()+scale_y_log10()+
  scale_color_brewer(palette = &quot;Dark2&quot;)</code></pre>
<p><img src="/post/2020-09-16-data-analysis-on-friends_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>library(tidytext)
friends%&gt;%select(-text)%&gt;%right_join(friends_emotions)%&gt;%
  count(speaker, emotion)%&gt;%add_count(speaker,name = &quot;num&quot;)%&gt;%
  filter(speaker!=&quot;NA&quot;)%&gt;%
  filter(num&gt;50)%&gt;%
  mutate(average_emo = n/num)%&gt;%
  ggplot(aes(y = reorder_within(speaker,average_emo,emotion), 
             x = average_emo, 
             color = emotion))+
  geom_point()+
  geom_segment(aes(x = 0,xend = average_emo,
                   y = reorder_within(speaker,average_emo,emotion), 
                   yend = reorder_within(speaker,average_emo,emotion)))+
  facet_wrap(~emotion,scales = &quot;free&quot;)+scale_y_reordered()+
  scale_color_brewer(palette = &quot;Paired&quot;)</code></pre>
<pre><code>## Joining, by = c(&quot;season&quot;, &quot;episode&quot;, &quot;scene&quot;, &quot;utterance&quot;)</code></pre>
<pre><code>## Using `n` as weighting variable
## ℹ Quiet this message with `wt = n` or count rows with `wt = 1`</code></pre>
<p><img src="/post/2020-09-16-data-analysis-on-friends_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>text&lt;-friends_info%&gt;%mutate(epi_num = row_number())%&gt;%
  select(season,episode,title,epi_num)%&gt;%
  right_join(friends, by = c(&quot;season&quot; = &quot;season&quot;, &quot;episode&quot; = &quot;episode&quot;))%&gt;%distinct(season,epi_num,title,text)

text%&gt;%
  unnest_tokens(word,text)%&gt;%
  anti_join(stop_words)%&gt;%inner_join(get_sentiments(&quot;afinn&quot;))%&gt;%
  group_by(season,epi_num,title)%&gt;%
  summarise(sent = sum(value))%&gt;%ungroup()%&gt;%ggplot(aes(x = epi_num, y = sent))+
  geom_point(aes(color = as.factor(season)))+geom_line(aes(color = as.factor(season)))+geom_text(aes(label = title),check_overlap = TRUE)+
  geom_smooth()+
  scale_color_brewer(palette = &quot;Paired&quot;)</code></pre>
<pre><code>## Joining, by = &quot;word&quot;
## Joining, by = &quot;word&quot;</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;epi_num&#39; (override with `.groups` argument)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/2020-09-16-data-analysis-on-friends_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>friends_rating &lt;- friends_info%&gt;%select(title,imdb_rating)

text%&gt;%
  unnest_tokens(word,text)%&gt;%
  anti_join(stop_words)%&gt;%inner_join(get_sentiments(&quot;afinn&quot;))%&gt;%
  group_by(season,epi_num,title)%&gt;%
  summarise(sent = sum(value))%&gt;%ungroup()%&gt;%left_join(friends_rating)%&gt;%
  ggplot(aes(x = sent, y = imdb_rating))+geom_point()+geom_smooth()</code></pre>
<pre><code>## Joining, by = &quot;word&quot;
## Joining, by = &quot;word&quot;</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;epi_num&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Joining, by = &quot;title&quot;</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/2020-09-16-data-analysis-on-friends_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>friends%&gt;%
  select(speaker, text)%&gt;%unnest_tokens(word, text)%&gt;%
  anti_join(stop_words)%&gt;%count(speaker,word)%&gt;%add_count(speaker)%&gt;%
  filter(nn&gt;7000)%&gt;%filter(speaker!=&quot;Scene Directions&quot;)%&gt;%select(-nn)%&gt;%
  bind_tf_idf(word, speaker,n)%&gt;%group_by(speaker)%&gt;%
  top_n(10,tf_idf)%&gt;%
  ggplot(aes(x = tf_idf,  y = reorder_within(word, tf_idf, speaker), fill = speaker))+
  geom_col()+facet_wrap(~speaker, scales = &quot;free_y&quot;)+scale_y_reordered()+
  scale_fill_brewer(palette = &quot;Paired&quot;)</code></pre>
<pre><code>## Joining, by = &quot;word&quot;</code></pre>
<pre><code>## Using `n` as weighting variable
## ℹ Quiet this message with `wt = n` or count rows with `wt = 1`</code></pre>
<pre><code>## Storing counts in `nn`, as `n` already present in input
## ℹ Use `name = &quot;new_name&quot;` to pick a new name.</code></pre>
<p><img src="/post/2020-09-16-data-analysis-on-friends_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
